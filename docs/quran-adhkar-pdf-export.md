# تحديثات صفحة القرآن والأذكار وتصدير المهام

**التاريخ:** {{ date('Y-m-d') }}

---

## ملخص التغييرات

تم تنفيذ ثلاث ميزات رئيسية:

### 1. تحسين صفحة القرآن والتنقل بين الأجزاء والسور

#### الملفات المُنشأة:
- `app/Services/QuranApiService.php` - خدمة بيانات القرآن

#### الميزات المضافة:
- **عرض السور الـ 114**: إمكانية التبديل بين عرض الأجزاء وعرض السور
- **البحث في السور**: خانة بحث للعثور على سورة معينة بسرعة
- **تفاصيل الجزء**: عند الضغط على أي جزء تظهر نافذة تعرض:
  - نطاق الصفحات
  - السور الموجودة في هذا الجزء
  - زر للانتقال لهذا الجزء
- **تفاصيل السورة**: عند الضغط على أي سورة تظهر معلومات تشمل:
  - اسم السورة بالعربية والإنجليزية
  - نوعها (مكية/مدنية)
  - عدد الآيات

#### بيانات QuranApiService:
- `JUZ_NAMES`: أسماء الأجزاء الثلاثين
- `SURAH_NAMES`: بيانات السور الـ 114 (الاسم، الإنجليزي، عدد الآيات، النوع)
- `JUZ_PAGE_RANGES`: نطاق الصفحات لكل جزء

---

### 2. صفحة الأذكار (أذكار الصباح والمساء)

#### الملفات المُنشأة:
- `app/Services/AdhkarService.php` - خدمة الأذكار
- `app/Http/Controllers/AdhkarController.php` - متحكم الأذكار
- `resources/views/decision-os/adhkar/index.blade.php` - صفحة الأذكار

#### الميزات:
- **التحديد التلقائي**: النظام يحدد تلقائياً أذكار الصباح أو المساء حسب الوقت
  - الصباح: من 4:00 صباحاً حتى 3:00 مساءً
  - المساء: من 3:00 مساءً حتى 4:00 صباحاً
- **عداد الأذكار**: لكل ذكر عداد يمكن الضغط عليه للعد
- **إكمال سريع**: زر لإكمال الذكر المتكرر دفعة واحدة
- **شريط التقدم**: يظهر نسبة الأذكار المكتملة
- **حفظ التقدم**: يتم حفظ التقدم في localStorage لليوم الحالي
- **رسالة التذكير**: تظهر في صفحة القرآن تذكير بالأذكار حسب الوقت

#### المسارات المضافة:
```
/decision-os/adhkar          - الأذكار المناسبة للوقت الحالي
/decision-os/adhkar/morning  - أذكار الصباح
/decision-os/adhkar/evening  - أذكار المساء
```

---

### 3. تصدير مهام اليوم كـ PDF/HTML

#### الملفات المُنشأة:
- `app/Services/TaskPdfService.php` - خدمة إنشاء تقارير المهام

#### الميزات:
- **تصدير للطباعة**: فتح صفحة HTML منسقة جاهزة للطباعة
- **تحميل HTML**: تحميل ملف HTML قابل للفتح لاحقاً
- **تصميم عربي**: التقرير منسق بالكامل بالعربية مع RTL
- **معلومات شاملة**:
  - التاريخ بالعربي والإنجليزي
  - إحصائيات (إجمالي، مكتملة، قيد التنفيذ)
  - Today One Thing
  - أهم 3 مهام
  - جميع المهام مع الحالة والملاحظات

#### المسارات المضافة:
```
/decision-os/tasks/export   - عرض التقرير للطباعة
/decision-os/tasks/download - تحميل التقرير كملف
```

---

## التغييرات على الملفات الموجودة

### app/Http/Controllers/QuranProgressController.php
- إضافة injection لـ QuranApiService و AdhkarService
- تمرير بيانات السور والأجزاء للـ View
- تمرير رسالة تذكير الأذكار

### app/Http/Controllers/TaskController.php
- إضافة `exportPdf()` method
- إضافة `downloadTasks()` method

### resources/views/decision-os/quran/index.blade.php
- إضافة تذكير الأذكار في أعلى الصفحة
- إضافة أزرار التبديل بين عرض الأجزاء والسور
- إضافة خانة البحث في السور
- إضافة modals لتفاصيل الأجزاء والسور

### resources/views/decision-os/tasks/today.blade.php
- إضافة dropdown للتصدير مع خيارات:
  - طباعة (فتح التقرير)
  - تحميل HTML
  - طباعة الصفحة الحالية

### resources/views/partials/sidebar.blade.php
- إضافة رابط الأذكار تحت رابط القرآن

### routes/web.php
- إضافة مسارات الأذكار (3 مسارات)
- إضافة مسارات تصدير المهام (2 مسارات)

### lang/ar/app.php & lang/en/app.php
- إضافة ترجمة `adhkar`
- إضافة ترجمة `life_metrics`

---

## سبب التغييرات

1. **التنقل في القرآن**: طلب المستخدم تحسين التنقل بين الأجزاء والسور لتسهيل متابعة القراءة
2. **الأذكار**: طلب المستخدم إضافة تذكير بأذكار الصباح والمساء حسب الوقت
3. **تصدير المهام**: طلب المستخدم إمكانية تصدير مهام اليوم كـ PDF للطباعة أو الحفظ

---

## ملاحظات تقنية

- **أسماء الأجزاء صحيحة**: تم التحقق من صحة أسماء الأجزاء عبر alquran.cloud API
- **لا حاجة لمكتبة PDF**: استخدام HTML+CSS للتصدير يعطي نتائج ممتازة للطباعة
- **localStorage**: يُستخدم لحفظ تقدم الأذكار مؤقتاً لليوم الحالي
- **Responsive Design**: جميع الصفحات متوافقة مع الشاشات المختلفة
